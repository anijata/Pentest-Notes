Simple Network Management Protocol (SNMP) is an application–layer protocol exchanging management information between network devices. [Basic explanation](https://www.manageengine.com/network-monitoring/what-is-snmp.html).

net-snmp: a suite of software for using and deploying SNMP.

[Hacktricks](https://book.hacktricks.xyz/network-services-pentesting/pentesting-snmp) contains various techniques explained throughout these notes below.

SNMP uses UDP ports 161, 162. Port 161 is used by SNMP manager to communicate at SNMP agents. Port 162 are used to SNMP Trap notifications from SNMP to notify the SNMP manager about network events. 

SNMP Management Information Base (MIB): A database organized as tree. Internal nodes represents different subdivisions of tree or network functions. Leaves of the tree hold variables called MIB values. SNMP can be used to query an SNMP agent's MIB.

[Object Identifier (OID)](https://en.wikipedia.org/wiki/Object_identifier): Identification mechanism used in MIB. Certain OIDs are important since these can be queried for specific information.
* Example: 1.3.6.1.2.1.25.4.2.1.2 OID can be used to obtain processes information on the host.
* Important OIDs for linux: http://www.linux-admins.net/2012/02/linux-snmp-oids-for-cpumemory-and-disk.html
* Important OIDs for windows:
   `|1.3.6.1.2.1.25.1.6.0|System Processes|
	|1.3.6.1.2.1.25.4.2.1.2|Running Programs|
	|1.3.6.1.2.1.25.4.2.1.4|Processes Path|
	|1.3.6.1.2.1.25.2.3.1.4|Storage Units|
	|1.3.6.1.2.1.25.6.3.1.2|Software Name|
	|1.3.6.1.4.1.77.1.2.25|User Accounts|
	|1.3.6.1.2.1.6.13.1.3|TCP Local Ports
	`

Other hosts can also be queried from an SNMP. Try using snmp walk to get their OIDs to query them. 

SNMP community string: A basic form of authentication used to access network devices and gather information through SNMP queries.
* Try community strings like "public", "private", "managers" and other strings using fuzzing.

NET-SNMP-EXTEND-MIB: An module for MIB to create objects and extend net-snmp.
* The module is a framework for scripted extensions for the Net-SNMP agent and can be used to query shell scripts.
* OIDs associated with this module: https://oidref.com/1.3.6.1.4.1.8072.1.3
* Most notable is `nsExtendObjects`. This display information about the shell scripts.
	* `snmpwalk -v{1|2c|3} -c <community string> <agent ip> NET-SNMP-EXTEND-MIB::nsExtendObjects`

Enumeration techniques:
* Nmap enumeration: Example:  nmap -sU --open -p 161 \<ip\>
* [onesixtyone](https://www.kali.org/tools/onesixtyone/): Enumerates given SNMP community strings and IPs.
	* Example: onesixtyone -c \<community strings file\> -i  \<IPs file\>
* Querying MIB values:
	* snmpwalk: Uses GETNEXT requests on SNMP agent to query information in the MIB.