* Credential_stuffing: Attacking services with the default or obtained credentials.
	* When you encounter a service with login, first see if it can be cracked with default credentials.
	* Seclists's default credentials wordlist to check if any default credentials are being used in a service.
	* [DefaultCreds-cheat-sheet](https://github.com/ihebski/DefaultCreds-cheat-sheet/blob/main/DefaultCreds-Cheat-Sheet.csv?plain=1) can also be used.
* Offline password cracking
	* Use HashCat or JTR suite (John the Ripper) or [CrackStation]([https://crackstation.net/](https://crackstation.net/)).
	* hashid can be used to identify hash type.
	* Mutating wordlists or rule based attack is when you write rules to change wordlists for password cracking. For example an organization uses a password policy of 1 uppercase, 1 special, 3 numbers then can use rules to change wordlists to reflect the password policy and crack the password.
	* Hashcat: 
		* Example: `hashcat -m <hash id> <hash> <wordlist> -r <rule file> --force`
		* /usr/share/hashcat/rules/ contains Hashcat rules. 
		* best64.rule is pretty good.
		* hashcat -h | grep -i "\<insert service name\>" can be used to get hash id as well.
		* Mutating wordlist with rule files using hashcat: `hashcat --force <worldist> -r <rule file> --stdout | sort -u > mut_password.list`
			* This mutated wordlist can used for hydra or crackmapexec etc
		* Hashcat wiki contains how rules can be built for hashcat.
	* John the ripper:
		* Example: `john [--incremental] [--format=<format>] --wordlist=<wordlist> [--rules=<rule>] <hash file>`
		* Append your rule to /etc/john/john.conf
	* Cracking password protected files and archives:
		* JTR suite tools like keepass2john, ssh2john, office2john can be used convert password protected files and archives to crackable hashes which can they be cracked using JTR.
		* `locate *2john*` for all the tools.
		* ssh keys: `ssh2john <ssh file>e > ssh.hash`
		* office docs: `office2john <doc file> > protected-docx.hash`
		* pdfs: `pdf2john <pdf file> > pdf.hash`
		* archives: `zip2john <zip file> > zip.hash`
		* Cracking OpenSSL Encrypted Archives
			* Check information for file format: `file <archive>`
			* Command for cracking: `for i in $(cat <wordlist>);do openssl enc -aes-256-cbc -d -in <archive> -k $i 2>/dev/null| tar xz;done`
		* Cracking BitLocker Encrypted Drives: `bitlocker2john -i <.vhd file> > backup.hashes`
* Online password cracking:
	* `Hydra`: 
		* Conduct dictionary attacks against SSH, RDP, HTTP login.
		* Usage: `hydra -l <user> -P <wordlist> -s <port> <protocol>://<ip>`
		* protocol can be ssh, rdp, http, https
		* -l \<user\>can be replaces -L \<user list\> and -p \<password\> instead of -P \<wordlist\> which can be used for password spraying attack.
		* HTTP GET or POST form:
			* Example: `hydra -l user -P /usr/share/wordlists/rockyou.txt \<ip\> http-post-form "/<url path>:<user parameter>=user&<password parameter>=^PASS^:<words from failure login page>"`
				* For http-post-form:
					* Can mention `C:/` for session cookie path. `:F=<http status>` code to indicate success or failure for login. 
					* `^USER64^`, `^PASS64^` can be used for base64 encoding. 
			* For GET replace with http-get-form
	* medusa: `medusa -u <user> -P <password> -h <ip> -M <protocol>`
	* Cracking Windows network services.:
		* `crackmapexec`: `sudo crackmapexec <proto> <target-IP> -u <user or userlist> -p <password or passwordlist>`
		* Can be used to crack protocols: smb, winrm, rdp etc. 
	* MetaSploit:
		* `auxiliary/scanner/smb/smb_login` module.
	* Wordlists for online password cracking:
		* Seclists's default credentials wordlist to check if any default credentials are being used in a service.
		* If you dont have any accounts you can try a built in accounts like root, user, Administrator. Use username wordlists: /usr/share/wordlists/dirb/others/names.txt
			* If you were able to get names from enumeration then they can be used to generate various possible usernames using `username-anarchy -i <names file>`
		* You can use services like ScatteredSecrets which password leaks to try attacking. Of course the passwords used must not violate terms of service and may require permission from owner.
		* You can use linux tool like `crunch` to generate simple wordlist files:
			* Usage: `crunch <min> <max> [options]`
		* Mutating wordlist with rule files using hashcat: `hashcat --force <worldist> -r <rule file> --stdout | sort -u > mut_password.list`
			* This mutated wordlist can used for hydra or crackmapexec etc
		* `CeWL`: Create a wordlist by spidering a URL for words to use for password cracking.
			* Usage: `CeWL <url>` 
* Linux passwd/shadow file cracking:
	*  If user has root permissions or somehow able to read passwd, shadow, opasswd files then extract password hashes from `/etc/passwd`(for older systems), `/etc/shadow`, `/etc/security/opasswd` and crack hashes using hashcat or john.
	* Using unshadow to combine passwd and shadow: `unshadow <passwd file> <shadow file> > unshadowed.hashes`
	* Cracking using john: `john unshadowed.hashes --wordlist=<wordlist>`