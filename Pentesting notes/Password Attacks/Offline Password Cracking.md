* Use HashCat or JTR suite (John the Ripper) or [CrackStation]([https://crackstation.net/](https://crackstation.net/)).
* hashid can be used to identify hash type.
* Mutating wordlists or rule based attack is when you write rules to change wordlists for password cracking. For example an organization uses a password policy of 1 uppercase, 1 special, 3 numbers then can use rules to change wordlists to reflect the password policy and crack the password.
* Hashcat: 
	* Example: `hashcat -m <hash id> <hash> <wordlist> -r <rule file> --force`
	* /usr/share/hashcat/rules/ contains Hashcat rules. 
	* best64.rule is pretty good.
	* hashcat -h | grep -i "\<insert service name\>" can be used to get hash id as well.
	* Mutating wordlist with rule files using hashcat: `hashcat --force <worldist> -r <rule file> --stdout | sort -u > mut_password.list`
		* This mutated wordlist can used for hydra or crackmapexec etc
	* Hashcat wiki contains how rules can be built for hashcat.
* John the ripper:
	* Example: `john [--incremental] [--format=<format>] --wordlist=<wordlist> [--rules=<rule>] <hash file>`
	* Append your rule to /etc/john/john.conf
* Cracking password protected files and archives:
	* JTR suite tools like keepass2john, ssh2john, office2john can be used convert password protected files and archives to crackable hashes which can they be cracked using JTR.
	* `locate *2john*` for all the tools.
	* ssh keys: `ssh2john <ssh file>e > ssh.hash`
	* office docs: `office2john <doc file> > protected-docx.hash`
	* pdfs: `pdf2john <pdf file> > pdf.hash`
	* archives: `zip2john <zip file> > zip.hash`
	* Cracking OpenSSL Encrypted Archives
		* Check information for file format: `file <archive>`
		* Command for cracking: `for i in $(cat <wordlist>);do openssl enc -aes-256-cbc -d -in <archive> -k $i 2>/dev/null| tar xz;done`
	* Cracking BitLocker Encrypted Drives: `bitlocker2john -i <.vhd file> > backup.hashes`
* Linux passwd/shadow file cracking:
	*  If user has root permissions or somehow able to read passwd, shadow, opasswd files then extract password hashes from `/etc/passwd`(for older systems), `/etc/shadow`, `/etc/security/opasswd` and crack hashes using hashcat or john.
	* Using unshadow to combine passwd and shadow: `unshadow <passwd file> <shadow file> > unshadowed.hashes`
	* Cracking using john: `john unshadowed.hashes --wordlist=<wordlist>`