
* Windows enumeration: Important to enumerate and enumerate before attempting the privilege escalation. 
* Below are some PowerShell commands to enumerate information:
	* Get-LocalUser: Get local users on the machine.
	* Get-LocalGroup: Get local users on the machine.
	* Get-LocalGroupMember \<group\>: Gets members of a group..
	* systeminfo: Gets system information.
	* ipconfig /all: Use it to list network interfaces.
	* route print: Get routing table.
	* netstat -ano: Get active connections (UDP/TCP)
	* Get-ItemProperty "HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*" : Use it to list 32 bit applications.
	* `Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*"` : Use it to list 64 bit applications.
	* Get-Process: Get all processes running.
	* whoami /priv: Gets list of privileges for the user.
		* Note: State can be Enabled/Disabled. However, disabled does not mean the privilege doesn't exist for the user. It means its not in use currently which can be changed by simply using the privilege.
* Password hunting: Users may carelessly leave sensitive information such as usernames, passwords in config files, desktop, application folders, git repos etc. 
	* https://juggernaut-sec.com/password-hunting/
* Use this to enumerate files that might be of interest. Modify it according to your need: `Get-ChildItem -Path <Path> -Include *.txt,*.log,*.pdf,*.xls,*.xlsx,*.doc,*.docx -File -Recurse -ErrorAction SilentlyContinue -Force`
* Check registry keys for credentials. 
	* https://viperone.gitbook.io/pentest-everything/everything/everything-active-directory/credential-access/unsecured-credentials/credentials-in-registry
* PowerShell history/logging: Get information from previously used commands from previous sessions and from logging.
	* Get-History: Gets PowerShell command history.
	* PSReadline module: Module used to enhance PowerShell commandline experience.  
		* PSReadline can have a separate PowerShell command history, used for predictive intelligence, which is not stored in the log file used by Get-History.
		* (Get-PSReadlineOption).HistorySavePath gets the log file location. Use it to get information.
	* PowerShell transcript: Start-Transcript cmdlet logs commands at a transcript file and stops logging with End-Transcript cmdlet. If you found the log file then you can cat the file.
		* Transcript files can have a default location pointed by a global variable $Transcript at the $HOME\\My Documents directory as \\PowerShell_transcript.\\<time-stamp\>.txt 
	* PowerShell Script Block Logging: PowerShell script block logs can be found in the event viewer if enabled on the machine.
		* Look for event ID 4104 found on "Applications and Services Logs > Microsoft > Windows > PowerShell > Operational" in the event viewer.
		* More details: https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_logging_windows?view=powershell-7.2
* Automated enumeration using winPEAS:
	* Automated tools can be blocked by AV solutions. If this is the case, apply techniques learned in the "Antivirus Evasion" section, try other tools such as [Seatbelt](https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/seatbelt) and [JAWS]((https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/jaws), or do the enumeration manually.
	* For kali linux [peass](https://www.kali.org/tools/peass-ng/) package contains privilege escalation tools which includes winPEASx64.exe a 64 bit PE. Transfer it to your target machine using Invoke-WebRequest (iwr) then invoke the exe.
	* Note automated tools save time but can give incorrect information from time to time. Switch to manual methods according to the situation.
* [Window Enumeration cheatsheet](https://nored0x.github.io/red-teaming/windows-enumeration/)