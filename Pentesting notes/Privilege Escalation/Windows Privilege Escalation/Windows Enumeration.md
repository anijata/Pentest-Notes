* Windows enumeration: Important to enumerate and enumerate before attempting the privilege escalation. 
* [Windows commands reference](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/windows-commands)
* [PayloadsAllTheThings Windows Privilege Escalation](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md)
* Below are some commands to enumerate information:
	* Get current user: `whoami`, `echo %USERNAME%`
	* `whoami /priv`: Gets list of privileges for the user.
	* `whoami /groups`: Get current user group memberships.
	* Get local users on the machine: `net user`, `Get-LocalUser`
	* Get local groups on the machine: `net localgroup`, `Get-LocalGroup`
	* Get members of a group: `net localgroup <group>`,`Get-LocalGroupMember <group>`
	* Get logged in users: `query user` 
	* Get Password Policy & Other Account Information: `net accounts`
	* `systeminfo`: Gets system information.
	* `ipconfig /all`: Use it to list network interfaces.
	* `arp -a`: ARP table
	* `route print`: Get routing table.
	* `netstat -ano`: Get active connections (UDP/TCP)
	* Get all processes running: `Get-Process`, `tasklist /svc`
	* List environment variables: `env`
	* Enumerate patches and updates: `systeminfo`, `wmic qfe`, `Get-HotFix | ft -AutoSize`
	* `Get-MpComputerStatus`: Get Windows Defender status.
	* Enumerate AppLocker policies:
		* Get AppLocker policies: `Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections`
		* Testing AppLocker policy: `Get-AppLockerPolicy -Local | Test-AppLockerPolicy -path <executable path> -User Everyone`
	* Enumerate services: Enumeration commands from [[Leveraging Windows Services]].
	* Get installed applications:
		* `Get-ItemProperty "HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*"` : Use it to list 32 bit applications.
		* `Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*"` : Use it to list 64 bit applications.
		* `wmic product get name`,`Get-WmiObject -Class Win32_Product`
* PowerShell history/logging: Get information from previously used commands from previous sessions and from logging.
	* Get-History: Gets PowerShell command history.
	* PSReadline module: Module used to enhance PowerShell commandline experience.  
		* PSReadline can have a separate PowerShell command history, used for predictive intelligence, which is not stored in the log file used by Get-History.
		* (Get-PSReadlineOption).HistorySavePath gets the log file location. Use it to get information.
	* PowerShell transcript: Start-Transcript cmdlet logs commands at a transcript file and stops logging with End-Transcript cmdlet. If you found the log file then you can cat the file.
		* Transcript files can have a default location pointed by a global variable $Transcript at the $HOME\\My Documents directory as \\PowerShell_transcript.\\<time-stamp\>.txt 
	* PowerShell Script Block Logging: PowerShell script block logs can be found in the event viewer if enabled on the machine.
		* Look for event ID 4104 found on "Applications and Services Logs > Microsoft > Windows > PowerShell > Operational" in the event viewer.
		* More details: https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_logging_windows?view=powershell-7.2
* Automated enumeration tools:
	* [Seatbelt](https://github.com/GhostPack/Seatbelt): C# project for performing a wide variety of local privilege escalation checks
	* [winPEAS](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS): WinPEAS is a script that searches for possible paths to escalate privileges on Windows hosts. All of the checks are explainedÂ [here](https://book.hacktricks.xyz/windows/checklist-windows-privilege-escalation)
	* [PowerUp](https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1): PowerShell script for finding common Windows privilege escalation vectors that rely on misconfigurations. It can also be used to exploit some of the issues found.
	* [SharpUp](https://github.com/GhostPack/SharpUp): C# version of PowerUp
	* [JAWS](https://github.com/411Hall/JAWS): PowerShell script for enumerating privilege escalation vectors written in PowerShell 2.0
	* [SessionGopher](https://github.com/Arvanaghi/SessionGopher): SessionGopher is a PowerShell tool that finds and decrypts saved session information for remote access tools. It extracts PuTTY, WinSCP, SuperPuTTY, FileZilla, and RDP saved session information
	* [Watson](https://github.com/rasta-mouse/Watson): Watson is a .NET tool designed to enumerate missing KBs and suggest exploits for Privilege Escalation vulnerabilities.
	* [LaZagne](https://github.com/AlessandroZ/LaZagne): Tool used for retrieving passwords stored on a local machine from web browsers, chat tools, databases, Git, email, memory dumps, PHP, sysadmin tools, wireless network configurations, internal Windows password storage mechanisms, and more
	* [Windows Exploit Suggester - Next Generation](https://github.com/bitsadmin/wesng): WES-NG is a tool based on the output of Windows' systeminfo utility which provides the list of vulnerabilities the OS is vulnerable to, including any exploits for these vulnerabilities. Every Windows OS between Windows XP and Windows 10, including their Windows Server counterparts, is supported
	* [Sysinternals Suite](https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite)
	* Automated tools can be blocked by AV solutions. If this is the case, apply techniques learned in the "Antivirus Evasion" section, try other tools such as [Seatbelt](https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/seatbelt) and [JAWS]((https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/jaws), or do the enumeration manually.
	* For kali linux [peass](https://www.kali.org/tools/peass-ng/) package contains privilege escalation tools which includes winPEASx64.exe a 64 bit PE. Transfer it to your target machine using Invoke-WebRequest (iwr) then invoke the exe.
	* Note automated tools save time but can give incorrect information from time to time. Switch to manual methods according to the situation.
* Named pipe enumeration:
	* List named pipes: `pipelist.exe /accepteula`, `gci \\.\pipe\`
	* Review pipe permissions: `accesschk.exe /accepteula \\.\Pipe\lsass -v`
* [Window Enumeration cheatsheet](https://nored0x.github.io/red-teaming/windows-enumeration/)